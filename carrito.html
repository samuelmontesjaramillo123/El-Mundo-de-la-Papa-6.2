<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrito de Compras - El SeÃ±or Papa</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
  <div class="header-content">
    <div class="logo-container">
      <a href="index.html">
        <img src="img general/logo.PNG" alt="Logo SeÃ±or Papa" class="logo">
      </a>
      <h1>EL SEÃ‘OR PAPA</h1>
    </div>

    <!-- BotÃ³n de menÃº hamburguesa -->
    <button class="menu-toggle" aria-label="Abrir menÃº">â˜°</button>

    <nav>
      <ul class="menu">
        <li><a href="index.html" class="activo">Inicio</a></li>
        <li><a href="productos.html">Productos</a></li>
        <li><a href="tabla.html">Tabla</a></li>
        <li><a href="formulario.html">ReservaciÃ³n</a></li>
        <li><a href="mision.html">Nuestra MisiÃ³n</a></li>
        <li><a href="medioambiente.html">Plan Ambiental</a></li>
        <li><a href="vision.html">Nuestra VisiÃ³n</a></li>
        <li class="carrito-icono">
          <a href="carrito.html">ğŸ›’ <span id="contador-carrito">0</span></a>
        </li>
      </ul>
    </nav>
  </div>
</header>


  <main class="carrito">
    <h2>ğŸ›ï¸ Tu Carrito de Compras</h2>
    <ul id="lista-carrito" class="lista-carrito"></ul>

    <div class="carrito-total">
      <p><strong>Total:</strong> $<span id="total">0</span></p>
      <button id="vaciar-carrito" class="btn-vaciar">Vaciar Carrito</button>
    </div>
    <!-- BotÃ³n para confirmar compra -->
<div class="confirmar-compra">
  <button id="confirmar-btn" class="btn-confirmar">Confirmar compra</button>
</div>

<!-- SecciÃ³n de mÃ©todo de pago (oculta al inicio) -->
<section id="metodo-pago" style="display: none; margin-top: 20px;">
  <h2>ğŸ’³ Selecciona tu mÃ©todo de pago</h2>

  <form id="form-pago">
    <label><input type="radio" name="pago" value="tarjeta" required> Tarjeta de crÃ©dito / dÃ©bito</label><br>
    <label><input type="radio" name="pago" value="efectivo"> Efectivo</label><br>
    <label><input type="radio" name="pago" value="transferencia"> Transferencia bancaria</label><br><br>
    <button type="submit" class="btn-finalizar">Finalizar compra</button>
  </form>
</section>
  </main>

  <script>
const listaCarrito = document.getElementById('lista-carrito');
const total = document.getElementById('total');
const vaciarBtn = document.getElementById('vaciar-carrito');
const contadorCarrito = document.getElementById('contador-carrito');

// Leer el carrito guardado o crear uno vacÃ­o
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];

// === FunciÃ³n principal para actualizar la vista del carrito ===
function actualizarCarrito() {
  listaCarrito.innerHTML = '';
  let totalPrecio = 0;
  let totalItems = 0;

  carrito.forEach((item, index) => {
    const subtotal = item.precio * item.cantidad;
    totalPrecio += subtotal;
    totalItems += item.cantidad;

    const li = document.createElement('li');
    li.innerHTML = `
      <strong>${item.nombre}</strong> (x${item.cantidad}) - $${subtotal.toFixed(2)}
      <button onclick="eliminarItem(${index})">âŒ</button>
    `;
    listaCarrito.appendChild(li);
  });

  // Mostrar el total general y cantidad de productos
  total.textContent = totalPrecio.toFixed(2);
  contadorCarrito.textContent = totalItems;

  // Guardar carrito actualizado
  localStorage.setItem("carrito", JSON.stringify(carrito));
}

// === Eliminar producto individual ===
function eliminarItem(index) {
  carrito.splice(index, 1);
  actualizarCarrito();
}

// === Vaciar todo el carrito ===
vaciarBtn.addEventListener('click', () => {
  carrito = [];
  actualizarCarrito();
});

// === Mostrar carrito al cargar la pÃ¡gina ===
actualizarCarrito();
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const span = document.getElementById('contador-carrito');

  function contarDesdeLocalStorage() {
    const raw = localStorage.getItem('carrito');
    if (!span) return; // si no existe el span no hacemos nada

    if (!raw) {
      span.textContent = 0;
      return 0;
    }

    try {
      const data = JSON.parse(raw);

      let total = 0;
      if (Array.isArray(data)) {
        // array de objetos {nombre, precio, cantidad} o array de strings
        if (data.length && typeof data[0] === 'object') {
          total = data.reduce((s, it) => s + (parseInt(it.cantidad) || 0), 0);
        } else {
          // array simple (nombres) -> contamos elementos
          total = data.length;
        }
      } else if (data && typeof data === 'object') {
        // quizÃ¡ guardaste { items: [...] }
        if (Array.isArray(data.items)) {
          total = data.items.reduce((s, it) => s + (parseInt(it.cantidad) || 0), 0);
        } else {
          total = 0;
        }
      } else {
        total = 0;
      }

      span.textContent = total;
      return total;
    } catch (err) {
      // si no es JSON vÃ¡lido, intenta contar por seguridad
      span.textContent = 0;
      return 0;
    }
  }

  // Inicializa contador al cargar la pÃ¡gina
  contarDesdeLocalStorage();

  // Escucha cambios en localStorage desde otras pestaÃ±as
  window.addEventListener('storage', (e) => {
    if (e.key === 'carrito') {
      contarDesdeLocalStorage();
    }
  });
});
</script>
<script>
  // BotÃ³n hamburguesa: abrir/cerrar menÃº
  const menuToggle = document.querySelector(".menu-toggle");
  const menu = document.querySelector(".menu");

  menuToggle.addEventListener("click", () => {
    menu.classList.toggle("mostrar");
  });
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const confirmarBtn = document.getElementById("confirmar-btn");
  const metodoPago = document.getElementById("metodo-pago");
  const formPago = document.getElementById("form-pago");

  // Ocultamos la secciÃ³n al inicio
  metodoPago.style.display = "none";

  // Al dar clic en confirmar compra
  confirmarBtn.addEventListener("click", () => {
    // Mostrar la secciÃ³n de mÃ©todo de pago con transiciÃ³n suave
    metodoPago.style.display = "block";
    metodoPago.style.opacity = "0";
    metodoPago.style.transition = "opacity 0.6s ease";
    setTimeout(() => metodoPago.style.opacity = "1", 50);

    // Desactivar el botÃ³n para que no se presione mÃ¡s de una vez
    confirmarBtn.disabled = true;
    confirmarBtn.textContent = "Mostrando opciones de pago...";
  });

  // Cuando se envÃ­a el formulario
  formPago.addEventListener("submit", (e) => {
    e.preventDefault();

    const metodo = document.querySelector('input[name="pago"]:checked').value;

    metodoPago.innerHTML = `
      <div class="mensaje-final" style="text-align:center; margin-top:20px;">
        <h2>ğŸ‰ Â¡Gracias por tu compra!</h2>
        <p>Has elegido pagar con <strong>${metodo}</strong>.</p>
        <p>Tu pedido serÃ¡ procesado pronto ğŸ¥”ğŸ’›</p>
        <a href="index.html" class="btn-volver">Volver al inicio</a>
      </div>
    `;

    // Limpia el carrito despuÃ©s del pago
    localStorage.removeItem("carrito");
    document.getElementById("contador-carrito").textContent = "0";
  });
});
</script>
</body>
</html>
